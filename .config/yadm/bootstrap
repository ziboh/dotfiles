cd "$HOME"
PYENV_PYTHON=3.10.9
if [ ! -d "$HOME/.pyenv" ]; then
    sudo apt update
    sudo apt install -y liblzma-dev git  wget build-essential libreadline-dev libncursesw5-dev libssl-dev libsqlite3-dev tk-dev libgdbm-dev libc6-dev libbz2-dev libffi-dev zlib1g-dev
    git clone https://github.com/pyenv/pyenv.git ~/.pyenv
    export PYENV_ROOT="$HOME/.pyenv"
    export PATH="$PYENV_ROOT/bin:$PATH"
    eval "$(pyenv init -)"
    pyenv install $PYENV_PYTHON
fi

if [  -d "$HOME/.pyenv" ];then
    if [ ! -d "$PYENV_ROOT/plugins/pyenv-virtualenv"]; then
        git clone https://github.com/pyenv/pyenv-virtualenv.git $(pyenv root)/plugins/pyenv-virtualenv
        eval "$(pyenv virtualenv-init -)"
        pyenv virtualenv $PYENV_PYTHON pynvim
    fi
fi

echo "Init submodules"
yadm submodule update --recursive --init
